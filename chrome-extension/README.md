# Google Chat Emotion Analyzer - Chrome拡張機能

Google Chatでのメッセージをリアルタイムで感情分析し、感情アイコンを表示するChrome拡張機能です。

## 🚀 **機能**

### ✅ **リアルタイム感情分析**
- Google Chatの新しいメッセージを自動検出
- 4つの基本感情（ポジティブ😊、ネガティブ😢、怒り😠、中立😐）を分析
- メッセージの横に感情アイコンと確信度を表示

### ✅ **バックエンド連携**
- 既存のNode.js/Express感情分析バックエンドと連携
- フォールバック機能でローカル分析も対応

### ✅ **統計情報**
- 処理済みメッセージ数の表示
- 感情分布の可視化
- 拡張機能ポップアップで確認可能

## 📦 **インストール手順**

### **1. 開発者モードでインストール**

1. **Chromeブラウザを開く**
2. **拡張機能ページにアクセス**: `chrome://extensions/`
3. **開発者モードを有効化**: 右上のトグルをオン
4. **「パッケージ化されていない拡張機能を読み込む」をクリック**
5. **`chrome-extension`フォルダを選択**

### **2. 権限の確認**
- ✅ `chat.google.com` へのアクセス権限
- ✅ アクティブタブへのアクセス権限

### **3. 動作確認**
1. **Google Chat** (`https://chat.google.com`) を開く
2. **拡張機能アイコン**をクリックしてポップアップを確認
3. **メッセージを送信**して感情アイコンが表示されることを確認

## 🛠️ **バックエンド連携**

### **前提条件**
- Node.js/Express バックエンドサーバーが`http://localhost:3001`で起動
- `/api/webhook/test-message` エンドポイントが利用可能

### **バックエンド未起動の場合**
- 自動的にローカル感情分析に切り替わります
- キーワードベースの簡易分析が実行されます

## 📊 **使用方法**

### **基本操作**
1. **Google Chatでメッセージを送信**
2. **感情アイコンが自動表示**される
3. **アイコンにマウスオーバー**で詳細情報を確認

### **統計情報の確認**
1. **拡張機能アイコンをクリック**
2. **ポップアップで統計を確認**
3. **「更新」ボタン**で最新情報を取得
4. **「クリア」ボタン**でデータをリセット

### **コンソールログ**
- ブラウザの開発者ツール（F12）のConsoleで詳細ログを確認可能

## 🔧 **技術仕様**

### **対応ブラウザ**
- Google Chrome (Manifest V3)
- Microsoft Edge (Chromium)

### **対応サイト**
- Google Chat (`https://chat.google.com/*`)

### **ファイル構成**
```
chrome-extension/
├── manifest.json      # 拡張機能設定
├── content.js         # メイン機能
├── content.css        # スタイル
├── popup.html         # ポップアップUI
├── popup.js           # ポップアップ機能
├── background.js      # サービスワーカー
└── README.md          # このファイル
```

### **メッセージ抽出セレクタ**
- **メッセージコンテナ**: `[data-id]`
- **メッセージテキスト**: `.DTp27d.QIJiHb`
- **送信者名**: `.njhDLd.O5OMdc`
- **タイムスタンプ**: `.FvYVyf`

## 🐛 **トラブルシューティング**

### **感情アイコンが表示されない**
1. 拡張機能が有効になっているか確認
2. Google Chatページをリロード
3. ブラウザのConsoleでエラーメッセージを確認

### **バックエンド接続エラー**
1. `http://localhost:3001` でバックエンドが起動しているか確認
2. CORS設定が正しいか確認
3. ローカル分析モードで動作するか確認

### **拡張機能がロードされない**
1. `manifest.json` の構文エラーを確認
2. Chrome拡張機能ページでエラーメッセージを確認
3. 開発者モードが有効になっているか確認

## 📋 **ログ出力例**

```
🚀 Chat Emotion Analyzer が起動しました！
🔍 Google Chatメッセージの監視を開始...
📝 既存メッセージ 3件を処理中...
👀 リアルタイムメッセージ監視を開始
✅ バックエンド接続成功: Chat Analyzer Backend
💬 メッセージ抽出成功: {messageId: "abc123", userName: "田中", content: "おはようございます！"}
🧠 感情分析を開始: おはようございます！
📊 感情分析結果: positive (85%)
🆕 新しいメッセージを検出: def456
```

## 🔄 **更新履歴**

- **v1.0.0**: 初回リリース
  - リアルタイムメッセージ検出
  - 感情分析とアイコン表示
  - バックエンド連携
  - 統計情報表示

## 📞 **サポート**

問題が発生した場合は、ブラウザの開発者ツール（F12）でConsoleログを確認し、エラーメッセージを記録してください。
