# 🔧 プロジェクト運用ルール集

## 📋 概要
本プロジェクト「Google Chat Emotion Analyzer」の開発・運用における各種ルールと方針をまとめた統合ドキュメントです。

---

## 1. 📝 Git管理ルール

### コミット戦略
- **会話ごとの必須コミット**: ファイル修正があれば必ずコミット
- **処理ごとの個別コミット**: 1つの処理完了 = 1つのコミット
- **段階的な進捗記録**: 大きな機能は複数コミットに分割

### コミットメッセージ形式
```
🔧 [機能名]: 具体的な修正内容

- 詳細な変更点1
- 詳細な変更点2
- 影響範囲や注意点
```

### プレフィックス
- `🎉` 新機能・大きなマイルストーン
- `🔧` 機能修正・改善
- `🐛` バグ修正
- `💄` UI/UX改善
- `📝` ドキュメント更新
- `🧪` テスト追加・修正
- `⚡` パフォーマンス改善
- `🔒` セキュリティ修正

詳細: `GIT_WORKFLOW.md`

---

## 2. 🏗️ 技術スタック・環境ルール

### 必須環境
- **Node.js**: >= 20.15.0
- **パッケージマネージャー**: pnpm
- **フロントエンド**: Vue 3 + TypeScript + Vite
- **バックエンド**: Node.js + Express + TypeScript
- **スタイリング**: Tailwind CSS

### バージョン管理方針
- **安定版優先**: プロダクションでは安定版のみ使用
- **互換性確認**: 各バージョン間の互換性を事前検証
- **段階的アップデート**: 一度に複数バージョンアップを避ける

詳細: `DEVELOPMENT_RULES.md`

---

## 3. 🔒 セキュリティ・機密情報管理

### 機密情報の取り扱い
- **Git管理対象外**: 
  - `oauth-setup.md`
  - `GOOGLE_CLIENT_SECRET`
  - `.env` ファイル
  - API キー・認証情報

### .gitignore 必須項目
```
# 機密情報
.env
*.env
oauth-setup.md
GOOGLE_CLIENT_SECRET
*.secret
*.key

# 依存関係・ビルド成果物
node_modules/
dist/
*.tsbuildinfo
```

### 開発時の注意事項
- **開発用キー**: 本番とは別の開発専用キーを使用
- **ログ出力**: APIキーやトークンをコンソールに出力しない
- **共有禁止**: 機密情報をチャット・メールで共有しない

---

## 4. 📁 ファイル・ディレクトリ命名規則

### Vue.js コンポーネント
- **ファイル名**: PascalCase (`GoogleAuth.vue`)
- **コンポーネント名**: PascalCase (`GoogleAuth`)
- **プロパティ**: camelCase (`isAuthenticated`)

### TypeScript ファイル
- **ファイル名**: kebab-case (`emotion-analyzer.ts`)
- **クラス名**: PascalCase (`EmotionAnalyzer`)
- **関数名**: camelCase (`analyzeEmotion`)
- **定数**: SCREAMING_SNAKE_CASE (`GOOGLE_CLIENT_ID`)

### ディレクトリ構造
```
src/
├── components/     # Vueコンポーネント
├── services/       # API・外部サービス
├── types/          # TypeScript型定義
├── utils/          # ユーティリティ関数
└── assets/         # 静的ファイル
```

---

## 5. 🧪 品質管理・テストルール

### テスト戦略
- **カバレッジ目標**: 80%以上
- **テストファーストアプローチ**: 主要機能は先にテストを記述
- **E2Eテスト**: 重要なユーザーフローは必須

### コード品質
- **TypeScript厳格モード**: `strict: true`
- **any型禁止**: 型安全性を最優先
- **ESLint/Prettier**: 自動フォーマット・ルール適用

### レビュー基準
- **動作確認済み**: すべての変更は事前にテスト
- **型安全性**: TypeScriptエラーが0件
- **パフォーマンス**: 不要な再レンダリング・重複処理の排除

---

## 6. 🎨 UI/UX デザインルール

### デザインシステム
- **カラーパレット**: Tailwind CSS標準カラー
- **感情カテゴリ色**:
  - 😊 Positive: 緑色系 (`text-green-500`)
  - 😢 Negative: 青色系 (`text-blue-500`)
  - 😠 Angry: 赤色系 (`text-red-500`)
  - 😐 Neutral: グレー系 (`text-gray-500`)

### レスポンシブ対応
- **モバイルファースト**: 最小幅320pxから対応
- **ブレークポイント**: Tailwind CSS標準
- **タッチ対応**: モバイルデバイスでの操作性確保

### アニメーション
- **transition-all**: 200ms ease-in-out
- **ホバーエフェクト**: `hover:scale-105`
- **読み込み**: スケルトンUIまたはスピナー

---

## 7. 🔄 Chrome拡張機能開発ルール

### 技術仕様
- **Manifest Version**: V3 必須
- **Content Scripts**: all_frames: true でiframe対応
- **権限最小化**: 必要最小限の権限のみ申請

### 開発・デバッグ
- **詳細ログ**: `console.log`でデバッグ情報を詳細に記録
- **エラーハンドリング**: try-catch で全ての例外をキャッチ
- **リロード頻度**: 修正のたびに拡張機能をリロード

### DOM操作
- **セレクタ精度**: ボタン要素を確実に除外
- **パフォーマンス**: MutationObserver の効率的な使用
- **Cross-origin対応**: iframe内での動作を前提とした設計

---

## 8. 📊 API・データ管理ルール

### Google Chat API
- **制限認識**: ボット専用APIの制限事項を把握
- **フォールバック**: スクレイピング手法をメイン戦略
- **レート制限**: API呼び出し頻度の管理

### 感情分析
- **Gemini API**: メイン分析エンジン
- **フォールバック機能**: キーワードベース分析を必ず実装
- **精度向上**: angryWords, frustratedPatterns の継続的改善

### データ保持
- **一時保存**: 10分間のデータのみ保持
- **プライバシー配慮**: 不要なデータは即座に削除
- **ログ管理**: 機密情報を含まないデバッグログのみ

---

## 9. 🚀 デプロイメント・運用ルール

### 環境管理
- **開発環境**: ローカル開発
- **テスト環境**: 実際のGoogle Chatでのテスト
- **本番環境**: 個人使用レベル

### 更新手順
1. **機能実装・テスト**
2. **段階的コミット**
3. **拡張機能リロード**
4. **動作確認**
5. **ドキュメント更新**

---

## 10. 📚 ドキュメント管理ルール

### 必須ドキュメント
- **README.md**: プロジェクト概要・セットアップ手順
- **GIT_WORKFLOW.md**: Git管理の詳細ルール
- **DEVELOPMENT_RULES.md**: 技術仕様・環境設定
- **chat.log**: 開発履歴・決定事項の記録

### 更新頻度
- **重要変更時**: 必ず関連ドキュメントを更新
- **API変更**: エンドポイント・インターフェース変更時
- **環境変更**: 依存関係・設定変更時

### 記録方針
- **決定事項**: なぜその選択をしたかの背景も記録
- **トラブルシューティング**: 解決方法と原因を詳細に記録
- **設定手順**: 第三者が再現できるレベルの詳細度

---

## 📞 連絡・相談ルール

### 質問・相談
- **技術的問題**: 具体的なエラーメッセージ・ログを添付
- **設計相談**: 複数の選択肢とそれぞれのメリット・デメリットを整理
- **進捗報告**: 完了したタスクと次のステップを明確化

### コミュニケーション
- **明確な表現**: 曖昧な表現を避け、具体的に記述
- **ログ・証拠**: 問題や成功の証拠となるログ・スクリーンショットを提供
- **建設的フィードバック**: 改善提案は代替案とセットで提示

---

**作成日**: 2025年9月26日  
**最終更新**: 2025年9月26日  
**バージョン**: 1.0.0

---

## 📋 関連ドキュメント
- [GIT_WORKFLOW.md](./GIT_WORKFLOW.md) - Git管理詳細ルール
- [DEVELOPMENT_RULES.md](./DEVELOPMENT_RULES.md) - 技術仕様・環境設定
- [APPLICATION_SPEC.md](./APPLICATION_SPEC.md) - アプリケーション仕様
- [README.md](./README.md) - プロジェクト概要・セットアップ
