# 📋 Chat Analyzer アプリケーション仕様書

## プロジェクト概要

### アプリケーション名
**Chat Analyzer** - Google Chat感情分析アプリケーション

### 目的
Google Chatでのリアルタイム会話において、参加者の感情をリアルタイムで分析・可視化し、チーム内のコミュニケーションを円滑にする。

### アプリケーション種別
SPA (Single Page Application) - リアルタイム監視型

## 🎯 主要機能

### 1. リアルタイム感情分析
- Google Chat APIからのWebhook経由でメッセージをリアルタイム取得
- Google Gemini APIを使用した感情分析
- 過去10分間のメッセージ履歴を考慮したコンテキスト分析

### 2. 感情可視化
- チャット参加者全員の現在の感情状態をリアルタイム表示
- 画面右側の固定エリアに感情モニターを配置
- ユーザー名と感情アイコンのペア表示

## 🎨 UI/UX仕様

### レイアウト構成
```
┌─────────────────────────────────┬──────────────────────┐
│ Google Chat Interface           │ 感情モニター         │
│                                 │                      │
│ 👤 ユーザーA: メッセージ...      │ 📊 チーム感情状況    │
│ 👤 ユーザーB: メッセージ...      │                      │
│ 👤 ユーザーC: メッセージ...      │ 👤 ユーザーA 😊      │
│                                 │ 👤 ユーザーB 😐      │
│ [メッセージ入力欄]              │ 👤 ユーザーC 😢      │
│                                 │                      │
│                                 │ [最終更新: XX:XX]   │
└─────────────────────────────────┴──────────────────────┘
```

### 感情表示仕様
- **表示位置**: 画面右側の固定エリア
- **表示形式**: ユーザー名 + 感情アイコンのみ
- **更新頻度**: メッセージ投稿時に即座に更新
- **プライバシー**: 全参加者の感情が全員に表示される

### 感情カテゴリ
| 感情カテゴリ | アイコン | 説明 |
|-------------|---------|------|
| ポジティブ | 😊 | 嬉しい、満足、期待、楽観的 |
| ネガティブ | 😢 | 悲しい、落胆、不安、心配 |
| 怒り | 😠 | 不満、イライラ、批判的、不快 |
| 中立 | 😐 | 普通、事実的、冷静、客観的 |

## 🔧 技術仕様

### フロントエンド
- **フレームワーク**: Vue 3 (Composition API)
- **言語**: TypeScript
- **ビルドツール**: Vite
- **パッケージマネージャー**: pnpm
- **UIライブラリ**: Tailwind CSS + Headless UI for Vue
- **アイコン**: Heroicons

### バックエンド
- **サーバー**: Node.js/Express
- **API通信**: Google Chat API (Webhook)
- **感情分析**: Google Gemini API
- **リアルタイム通信**: WebSocket
- **認証**: Google OAuth 2.0

### 開発・デプロイ環境
- **コンテナ化**: Docker + Docker Compose
- **開発環境**: Dev Container（VSCode）
- **CI/CD**: GitHub Actions（予定）

### データフロー
```
Google Chat → Webhook → バックエンド → Gemini API → WebSocket → フロントエンド
```

## 📊 機能詳細仕様

### 1. メッセージ取得・分析フロー
1. Google Chatでメッセージが投稿される
2. Webhookが発火し、バックエンドがメッセージを受信
3. 過去10分間のメッセージ履歴を含めてコンテキストを構築
4. Gemini APIで感情分析を実行
5. 分析結果をWebSocket経由でフロントエンドに送信
6. 感情モニターのUIを即座に更新

### 2. 感情分析ロジック
- **分析対象**: 投稿されたメッセージ + 過去10分間のメッセージ履歴
- **分析粒度**: ユーザー単位（ユーザーごとの現在の感情状態）
- **更新タイミング**: メッセージ投稿時のリアルタイム
- **結果有効期間**: 10分間（新しいメッセージがない場合は中立に戻る）

### 3. UI動作仕様
- **初回ロード**: 過去10分間のメッセージを分析して初期状態を表示
- **リアルタイム更新**: WebSocket接続によるリアルタイム感情状態更新
- **レスポンシブ対応**: デスクトップ、タブレット、スマートフォン対応
- **アクセシビリティ**: キーボードナビゲーション、スクリーンリーダー対応

## 🔐 セキュリティ・プライバシー

### データ取り扱い
- **メッセージデータ**: 感情分析後は保存せず破棄
- **感情分析結果**: 10分間のみ一時保存
- **ユーザー情報**: Google OAuth経由での最小限の情報取得

### 認証・認可
- **ユーザー認証**: Google OAuth 2.0
- **API認証**: Google Chat API、Gemini API用のサービスアカウント
- **権限管理**: Google Workspace内のチャットルームへのアクセス権限

## 🚀 パフォーマンス要件

### レスポンス時間
- **感情分析処理**: 3秒以内
- **UI更新**: 1秒以内
- **初回ロード**: 5秒以内

### スケーラビリティ
- **同時接続数**: 100ユーザーまで（初期目標）
- **メッセージ処理量**: 1000メッセージ/分まで
- **チャットルーム数**: 10ルームまで同時監視

## 🧪 テスト要件

### テストレベル
1. **ユニットテスト**: 感情分析ロジック、UI コンポーネント
2. **統合テスト**: API連携、WebSocket通信
3. **E2Eテスト**: ユーザーフロー全体

### テストシナリオ
- リアルタイムメッセージ受信・分析・表示
- 複数ユーザーの同時メッセージ投稿
- 長時間接続時の安定性
- ネットワーク切断・再接続時の動作

## 📈 今後の拡張予定

### Phase 2 機能
- 感情推移グラフ表示
- 感情統計・レポート機能
- カスタム感情カテゴリ追加

### Phase 3 機能
- 複数チャットルーム同時監視
- アラート機能（ネガティブ感情検知時）
- 管理者ダッシュボード

---

**作成日**: 2025年9月18日  
**バージョン**: 1.0.0  
**ステータス**: 承認済み
